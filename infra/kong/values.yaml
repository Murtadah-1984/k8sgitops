# Kong Gateway Helm Values
# Production-ready configuration with node affinity for dedicated nodes

deployment:
  kong:
    enabled: true
    image:
      repository: kong/kong
      tag: "3.4"
    replicas: 3
    nodeSelector:
      node.kong.gateway: "true"
    tolerations:
      - key: node.kong.gateway
        operator: Equal
        value: "true"
        effect: NoSchedule
    resources:
      limits:
        cpu: 2000m
        memory: 2Gi
      requests:
        cpu: 500m
        memory: 512Mi
  
  ingressController:
    enabled: true
    installCRDs: true

# Database configuration (PostgreSQL recommended for production)
env:
  database: "postgres"
  pg_host: "postgresql.kong.svc.cluster.local"
  pg_port: "5432"
  pg_user: "kong"
  pg_password: "" # Use External Secrets Operator
  pg_database: "kong"

# Enable Kong Manager and Kong Admin API
admin:
  enabled: true
  http:
    enabled: true
  tls:
    enabled: true

manager:
  enabled: true
  http:
    enabled: true
  tls:
    enabled: true

# Proxy configuration
proxy:
  type: LoadBalancer
  http:
    enabled: true
    servicePort: 80
  tls:
    enabled: true
    servicePort: 443

# Health checks
readinessProbe:
  httpGet:
    path: /ready
    port: 8100
  initialDelaySeconds: 10
  periodSeconds: 10

livenessProbe:
  httpGet:
    path: /health
    port: 8100
  initialDelaySeconds: 30
  periodSeconds: 30

