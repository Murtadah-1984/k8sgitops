# Bitnami Kong Gateway Helm Values
# Production configuration with VIP LoadBalancer and dedicated nodes

replicaCount: 3

image:
  debug: false

service:
  type: LoadBalancer
  loadBalancerIP: "10.0.50.10"   # VIP for Kong ingress
  ports:
    http: 80
    https: 443

ingressController:
  enabled: false   # Using Kong as API Gateway, not Ingress Controller

proxy:
  enabled: true

env:
  database: "postgres"
  trusted_ips: 0.0.0.0/0
  real_ip_header: "X-Forwarded-For"

postgresql:
  enabled: true

resources:
  limits:
    cpu: "2"
    memory: "4Gi"
  requests:
    cpu: "1"
    memory: "2Gi"

# -------------------------------------
# NODE AFFINITY (force run on kong nodes)
# -------------------------------------
affinity:
  nodeAffinity:
    requiredDuringSchedulingIgnoredDuringExecution:
      nodeSelectorTerms:
        - matchExpressions:
            - key: node-role.kong
              operator: In
              values:
                - "true"

# -------------------------------------
# Tolerate your taint
# -------------------------------------
tolerations:
  - key: "app"
    operator: "Equal"
    value: "kong"
    effect: "NoSchedule"
